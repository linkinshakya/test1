<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="utf-8">
Â  <title>Memory Game & Math Quiz</title>
Â  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
Â  <meta name="theme-color" content="#4f46e5">
Â  <style>
Â  Â  :root {
Â  Â  Â  --bg: #f8fafc;
Â  Â  Â  --card: #ffffff;
Â  Â  Â  --primary: #4f46e5;
Â  Â  Â  --primary-fore: #ffffff;
Â  Â  Â  --text: #0f172a;
Â  Â  Â  --muted: #64748b;
Â  Â  Â  --ring: #a5b4fc;
Â  Â  Â  --shadow: 0 10px 20px rgba(0,0,0,0.08);
Â  Â  }
Â  Â  * { box-sizing: border-box; }
Â  Â  html, body {
Â  Â  Â  margin: 0;
Â  Â  Â  padding: 0;
Â  Â  Â  height: 100%;
Â  Â  Â  background: var(--bg);
Â  Â  Â  color: var(--text);
Â  Â  Â  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji";
Â  Â  Â  -webkit-tap-highlight-color: transparent;
Â  Â  }
Â  Â  /* Dynamic viewport for mobile */
Â  Â  .screen {
Â  Â  Â  width: 100%;
Â  Â  Â  height: 100vh;Â  Â  Â  Â  Â  Â  Â  /* fallback */
Â  Â  Â  height: 100dvh;Â  Â  Â  Â  Â  Â  Â /* modern */
Â  Â  Â  height: calc(var(--vh, 1vh) * 100); /* JS-updated */
Â  Â  Â  display: none;
Â  Â  Â  flex-direction: column;
Â  Â  }
Â  Â  .screen.show { display: flex; }

Â  Â  /* Menu */
Â  Â  .menu {
Â  Â  Â  background: linear-gradient(180deg, #6366f1, #4338ca);
Â  Â  Â  color: white;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  padding: 24px;
Â  Â  Â  text-align: center;
Â  Â  Â  gap: 16px;
Â  Â  }
Â  Â  .menu .box {
Â  Â  Â  width: min(560px, 100%);
Â  Â  Â  background: rgba(255,255,255,0.12);
Â  Â  Â  border: 1px solid rgba(255,255,255,0.2);
Â  Â  Â  border-radius: 20px;
Â  Â  Â  padding: 24px;
Â  Â  Â  box-shadow: var(--shadow);
Â  Â  Â  backdrop-filter: blur(6px);
Â  Â  }
Â  Â  .title { font-size: 28px; font-weight: 800; letter-spacing: 0.2px; margin: 0 0 8px; }
Â  Â  .sub { opacity: .95; margin: 0 0 20px; }
Â  Â  .row { display:flex; flex-direction:column; gap:12px }
Â  Â  @media (min-width: 520px){ .row{ flex-direction:row; justify-content:center } }

Â  Â  .btn {
Â  Â  Â  display: inline-flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  gap: 8px;
Â  Â  Â  padding: 14px 18px;
Â  Â  Â  font-weight: 700;
Â  Â  Â  border-radius: 14px;
Â  Â  Â  border: none;
Â  Â  Â  cursor: pointer;
Â  Â  Â  box-shadow: var(--shadow);
Â  Â  Â  transition: transform .12s ease, opacity .2s ease;
Â  Â  Â  background: white; color: #312e81;
Â  Â  }
Â  Â  .btn:active { transform: scale(.97); }
Â  Â  .btn.secondary { background: #eef2ff; color: #3730a3; }

Â  Â  /* Top bars */
Â  Â  .hud, .mq-hud {
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: space-between;
Â  Â  Â  padding: 12px 14px;
Â  Â  Â  background: #fff;
Â  Â  Â  box-shadow: 0 1px 0 rgba(15,23,42,.05), var(--shadow);
Â  Â  Â  z-index: 2;
Â  Â  Â  gap: 8px;
Â  Â  }
Â  Â  .stat { font-weight: 700; }
Â  Â  .time { font-variant-numeric: tabular-nums; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }
Â  Â  .btn.small { padding: 10px 12px; font-weight: 600; border-radius: 10px; background: var(--primary); color: var(--primary-fore); }
Â  Â  .btn.light { background:#fff; color:#111827; border:1px solid #e5e7eb }

Â  Â  /* MEMORY GAME styles (from your code) */
Â  Â  .start {
Â  Â  Â  background: linear-gradient(180deg, #6366f1, #4338ca);
Â  Â  Â  color: white;
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  padding: 24px;
Â  Â  Â  text-align: center;
Â  Â  }
Â  Â  .start .box {
Â  Â  Â  width: min(520px, 100%);
Â  Â  Â  background: rgba(255,255,255,0.12);
Â  Â  Â  border: 1px solid rgba(255,255,255,0.2);
Â  Â  Â  border-radius: 20px;
Â  Â  Â  padding: 24px;
Â  Â  Â  box-shadow: var(--shadow);
Â  Â  Â  backdrop-filter: blur(6px);
Â  Â  }

Â  Â  .board {
Â  Â  Â  flex: 1;
Â  Â  Â  padding: 14px;
Â  Â  Â  display: grid;
Â  Â  Â  grid-template-columns: repeat(4, 1fr); /* Default, will be overridden */
Â  Â  Â  gap: 10px;
Â  Â  Â  align-content: center;
Â  Â  Â  width: 100%; /* Ensure max width is used for centering */
Â  Â  Â  max-width: 600px;
Â  Â  Â  margin: 0 auto;
Â  Â  }
Â  Â  .card { position: relative; perspective: 1000px; border-radius: 16px; box-shadow: var(--shadow); outline: none; }
Â  Â  .cardBtn { appearance: none; -webkit-appearance: none; cursor: pointer; width: 100%; height: 100%; border: none; background: transparent; padding: 0; border-radius: 16px; }
Â  Â  .inner { position: relative; width: 100%; aspect-ratio: 1 / 1; transform-style: preserve-3d; transition: transform .35s ease; border-radius: 16px; overflow: hidden; }
Â  Â  .card.flipped .inner, .card.matched .inner { transform: rotateY(180deg); }
Â  Â  .face { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; backface-visibility: hidden; border-radius: 16px; font-size: clamp(24px, 6.4vw, 40px); user-select: none; }
Â  Â  /* Adjust font size for smaller cards */
Â  Â  #board[style*="grid-template-columns: repeat(6"] .face,
Â  Â  #board[style*="grid-template-columns: repeat(5"] .face { font-size: clamp(16px, 4.2vw, 24px); }

Â  Â  .front { background: var(--card); }
Â  Â  .back { transform: rotateY(180deg); background: radial-gradient(circle at 30% 30%, #6366f1, #4f46e5); color: white; letter-spacing: .2em; font-weight: 800; }
Â  Â  .matched .front { background: #e7f9ef; border: 2px solid #34d399; }
Â  Â  .overlay { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(0,0,0,.6); backdrop-filter: blur(4px); z-index: 5; padding: 16px; }
Â  Â  .overlay.show { display: flex; }
Â  Â  .panel { width: 100%; max-width: 360px; background: #fff; border-radius: 18px; padding: 20px; text-align: center; box-shadow: var(--shadow); }
Â  Â  .panel h2 { margin: 0 0 6px; font-size: 22px; }
Â  Â  .muted { color: var(--muted); }

Â  Â  /* MATH QUIZ styles */
Â  Â  .mq-main{ flex:1; display:flex; flex-direction:column; gap:14px; align-items:center; justify-content:center; padding:16px }
Â  Â  .mq-q{ font-size:clamp(20px,6.5vw,36px); font-weight:900; text-align:center; padding: 0 10px; }
Â  Â  .mq-opts{ width:100%; max-width:560px; display:grid; grid-template-columns:repeat(2,1fr); gap:12px }
Â  Â  .mq-opt{ padding:16px 14px; border-radius:16px; border:none; background:#fff; box-shadow:var(--shadow); font-size:clamp(18px,4.8vw,22px); font-weight:800; cursor:pointer; touch-action:manipulation; transition:transform .1s ease }
Â  Â  .mq-opt:active{ transform:scale(.98) }
Â  Â  .mq-opt.correct{ background:#dcfce7; border:2px solid #22c55e }
Â  Â  .mq-opt.wrong{ background:#fee2e2; border:2px solid #ef4444 }
Â  Â  .mq-tag{ padding:6px 10px; border-radius:999px; background:#ecfeff; border:1px solid #a5f3fc; font-weight:700; font-size:12px }
Â  Â  .mq-footer{ display:flex; gap:10px; align-items:center; justify-content:center; padding:12px }
Â  Â  .pill{ padding:8px 12px; border-radius:999px; background:#fff; box-shadow:var(--shadow); font-weight:700 }

Â  Â  /* Utility */
Â  Â  [hidden] { display: none !important; }
Â  </style>
</head>
<body>

Â  Â  <section id="menu" class="screen menu show" role="main" aria-label="Choose a game">
Â  Â  <div class="box">
Â  Â  Â  <h1 class="title">Choose a Game</h1>
Â  Â  Â  <p class="sub">Pick one to start. Both are mobileâ€‘friendly and fullâ€‘screen.</p>
Â  Â  Â  <div class="row">
Â  Â  Â  Â  <button id="goMemory" class="btn">ðŸŽ´ Memory Game</button>
Â  Â  Â  Â  <button id="goMath" class="btn secondary">âž• Math Quiz</button>
Â  Â  Â  </div>
Â  Â  </div>
Â  </section>

Â  Â  Â  <section id="startScreen" class="screen start" aria-label="Memory start">
Â  Â  <div class="box" aria-live="polite">
Â  Â  Â  <h1 class="title">Memory Game</h1>
Â  Â  Â  <p class="sub">Match all the pairs. Fast taps, sharp memory!</p>
Â  Â  Â  <div style="display:flex; gap:8px; justify-content:center; margin:10px 0 18px">
Â  Â  Â  Â  <label for="memLevelStart" style="font-weight:700">Difficulty:</label>
Â  Â  Â  Â  <select id="memLevelStart" class="btn light" style="padding:10px 12px; border-radius:10px; border:1px solid #e5e7eb">
Â  Â  Â  Â  Â  <option value="lvl1">Level 1 (2x2, 2 Pairs)</option>
Â  Â  Â  Â  Â  <option value="lvl2">Level 2 (3x2, 3 Pairs)</option>
Â  Â  Â  Â  Â  <option value="lvl3">Level 3 (4x2, 4 Pairs)</option>
Â  Â  Â  Â  Â  <option value="lvl4">Level 4 (4x3, 6 Pairs)</option>
Â  Â  Â  Â  Â  <option value="lvl5" selected>Level 5 (4x4, 8 Pairs)</option>
Â  Â  Â  Â  Â  <option value="lvl6">Level 6 (5x4, 10 Pairs)</option>
Â  Â  Â  Â  Â  <option value="lvl7">Level 7 (5x5, 12 Pairs)</option>
Â  Â  Â  Â  Â  <option value="lvl8">Level 8 (6x4, 12 Pairs)</option>
Â  Â  Â  Â  Â  <option value="lvl9">Level 9 (6x5, 15 Pairs)</option>
Â  Â  Â  Â  Â  <option value="lvl10">Level 10 (6x6, 18 Pairs)</option>
Â  Â  Â  Â  </select>
Â  Â  Â  </div>
Â  Â  Â  <div style="display:flex; gap:8px; justify-content:center;">
Â  Â  Â  Â  <button id="memBack" class="btn light" aria-label="Back to menu">Back to menu</button>
Â  Â  Â  Â  <button id="startBtn" class="btn" aria-label="Start playing">Start playing â–¶</button>
Â  Â  Â  </div>
Â  Â  </div>
Â  </section>

Â  Â  <section id="gameScreen" class="screen" aria-label="Memory game">
Â  Â  <header class="hud" role="toolbar" aria-label="Game controls">
Â  Â  Â  <div style="display:flex; gap:8px; align-items:center">
Â  Â  Â  Â  <button id="memBackInGame" class="btn small light" aria-label="Back to menu">Back</button>
Â  Â  Â  Â  <div class="stat">Moves: <span id="moves">0</span></div>
Â  Â  Â  </div>
Â  Â  Â  <div class="time" id="clock">00:00</div>
Â  Â  Â  <button id="restartBtn" class="btn small" aria-label="Restart game">Restart</button>
Â  Â  </header>
Â  Â  <div id="board" class="board" aria-label="Memory board"></div>
Â  </section>

Â  Â  <div id="winOverlay" class="overlay" aria-modal="true" role="dialog" aria-labelledby="winTitle" aria-describedby="winStats">
Â  Â  <div class="panel">
Â  Â  Â  <h2 id="winTitle">You win! ðŸŽ‰</h2>
Â  Â  Â  <p id="winStats" class="muted">0 moves Â· 00:00</p>
Â  Â  Â  <button id="playAgainBtn" class="btn small" style="margin-top:10px;">Play again</button>
Â  Â  </div>
Â  </div>

Â  Â  Â  <section id="mqStart" class="screen start" aria-label="Math quiz start">
Â  Â  <div class="box">
Â  Â  Â  <h1 class="title">Math Quiz</h1>
Â  Â  Â  <p class="sub">Weâ€™ll ask at least one question from each category first. You can still pick a preferred difficulty.</p>
Â  Â  Â  <div style="display:flex; gap:8px; justify-content:center; margin:10px 0 18px">
Â  Â  Â  Â  <label for="levelStart" style="font-weight:700">Preferred:</label>
Â  Â  Â  Â  <select id="levelStart" class="btn light" style="padding:10px 12px; border-radius:10px; border:1px solid #e5e7eb">
Â  Â  Â  Â  Â  <option value="basic">1: Basic Arithmetic</option>
Â  Â  Â  Â  Â  <option value="c6">2: Whole Numbers</option>
Â  Â  Â  Â  Â  <option value="c7">3: Multiplication/Subtraction</option>
Â  Â  Â  Â  Â  <option value="c8">4: All Operations</option>
Â  Â  Â  Â  Â  <option value="c9">5: Order of Operations</option>
Â  Â  Â  Â  Â  <option value="c10">6: Exponents/Distributive</option>
Â  Â  Â  Â  Â  <option value="adult">7: Decimals/Percentages (L1)</option>
Â  Â  Â  Â  Â  <option value="advanced">8: Decimals/Percentages (L2)</option>
Â  Â  Â  Â  Â  <option value="prealgebra">9: Pre-Algebra</option>
Â  Â  Â  Â  Â  <option value="algebra">10: Algebra/Equations</option>
Â  Â  Â  Â  Â  <option value="graduate">11: Graduate Level</option>
Â  Â  Â  Â  </select>
Â  Â  Â  </div>
Â  Â  Â  <div style="display:flex; gap:8px; justify-content:center;">
Â  Â  Â  Â  <button id="mqBack" class="btn light" aria-label="Back to menu">Back to menu</button>
Â  Â  Â  Â  <button id="mqPlay" class="btn" aria-label="Start playing">Start playing â–¶</button>
Â  Â  Â  </div>
Â  Â  </div>
Â  </section>

Â  Â  <section id="mqGame" class="screen" aria-label="Math quiz game">
Â  Â  <header class="mq-hud" role="toolbar" aria-label="Math game controls">
Â  Â  Â  <div style="display:flex; gap:8px; align-items:center">
Â  Â  Â  Â  <button id="mqBackInGame" class="btn small light" aria-label="Back to menu">Back</button>
Â  Â  Â  Â  <div class="stat">Score: <span id="score">0</span></div>
Â  Â  Â  Â  <div class="muted">Q: <span id="count">0</span></div>
Â  Â  Â  </div>
Â  Â  Â  <div style="display:flex; align-items:center; gap:8px">
Â  Â  Â  Â  <span class="mq-tag" id="nowTag">Now: Basic</span>
Â  Â  Â  Â  <label for="level" class="muted" style="font-weight:700">Preferred</label>
Â  Â  Â  Â  <select id="level" class="btn light" style="padding:8px 10px; border-radius:10px; border:1px solid #e5e7eb">
Â  Â  Â  Â  Â  <option value="basic">1: Basic Arithmetic</option>
Â  Â  Â  Â  Â  <option value="c6">2: Whole Numbers</option>
Â  Â  Â  Â  Â  <option value="c7">3: Multiplication/Subtraction</option>
Â  Â  Â  Â  Â  <option value="c8">4: All Operations</option>
Â  Â  Â  Â  Â  <option value="c9">5: Order of Operations</option>
Â  Â  Â  Â  Â  <option value="c10">6: Exponents/Distributive</option>
Â  Â  Â  Â  Â  <option value="adult">7: Decimals/Percentages (L1)</option>
Â  Â  Â  Â  Â  <option value="advanced">8: Decimals/Percentages (L2)</option>
Â  Â  Â  Â  Â  <option value="prealgebra">9: Pre-Algebra</option>
Â  Â  Â  Â  Â  <option value="algebra">10: Algebra/Equations</option>
Â  Â  Â  Â  Â  <option value="graduate">11: Graduate Level</option>
Â  Â  Â  Â  </select>
Â  Â  Â  </div>
Â  Â  Â  <button id="mqRestart" class="btn small">Restart</button>
Â  Â  </header>

Â  Â  <main class="mq-main">
Â  Â  Â  <div id="question" class="mq-q">â€”</div>
Â  Â  Â  <div id="options" class="mq-opts"></div>
Â  Â  </main>

Â  Â  <footer class="mq-footer">
Â  Â  Â  <div class="pill">Tap an option to continue</div>
Â  Â  </footer>
Â  </section>

Â  <script>
Â  Â  /* ===== Viewport height fix for mobile address bar ===== */
Â  Â  function setVH() {
Â  Â  Â  document.documentElement.style.setProperty('--vh', window.innerHeight * 0.01 + 'px');
Â  Â  }
Â  Â  setVH();
Â  Â  window.addEventListener('resize', setVH);
Â  Â  window.addEventListener('orientationchange', setVH);

Â  Â  /* ===== Screens ===== */
Â  Â  const scrMenu = document.getElementById('menu');

Â  Â  // Memory screens
Â  Â  const memStart = document.getElementById('startScreen');
Â  Â  const memGameÂ  = document.getElementById('gameScreen');
Â  Â  const memLevelStart = document.getElementById('memLevelStart');

Â  Â  // Math quiz screens
Â  Â  const mqStartÂ  = document.getElementById('mqStart');
Â  Â  const mqGameÂ  Â = document.getElementById('mqGame');

Â  Â  function show(screen) {
Â  Â  Â  // hide all
Â  Â  Â  [scrMenu, memStart, memGame, mqStart, mqGame].forEach(s => s.classList.remove('show'));
Â  Â  Â  screen.classList.add('show');
Â  Â  }

Â  Â  /* ===== MENU buttons ===== */
Â  Â  document.getElementById('goMemory').addEventListener('click', () => show(memStart));
Â  Â  document.getElementById('goMath').addEventListener('click', () => show(mqStart));

Â  Â  /* ======= MEMORY GAME (10 Levels) ======= */
Â  Â  const boardElÂ  Â  Â = document.getElementById('board');
Â  Â  const startBtnÂ  Â  = document.getElementById('startBtn');
Â  Â  const restartBtnÂ  = document.getElementById('restartBtn');
Â  Â  const playAgainBtn= document.getElementById('playAgainBtn');
Â  Â  const movesElÂ  Â  Â = document.getElementById('moves');
Â  Â  const clockElÂ  Â  Â = document.getElementById('clock');
Â  Â  const winOverlayÂ  = document.getElementById('winOverlay');
Â  Â  const winStatsElÂ  = document.getElementById('winStats');
Â  Â  const memBackÂ  Â  Â = document.getElementById('memBack');
Â  Â  const memBackInGame = document.getElementById('memBackInGame');

Â  Â  // 18 pairs max for 6x6=36 cards
Â  Â  const allSymbols = ['ðŸŽ','ðŸš€','ðŸ¨','ðŸŽ§','ðŸŒž','âš½','ðŸš²','ðŸ“š','ðŸ’¡','ðŸ”‘','âš™ï¸','ðŸ’Ž','ðŸ‘‘','ðŸ„','ðŸŒˆ','ðŸ¦','ðŸ›¸','ðŸ§©'];
Â  Â  Â  Â  
Â  Â  const memLevels = {
Â  Â  Â  'lvl1': { pairs: 2, cols: 2, name: '2x2 (Beginner)' },Â  // 4 cards
Â  Â  Â  'lvl2': { pairs: 3, cols: 3, name: '3x2 (Easy)' },Â  Â  // 6 cards
Â  Â  Â  'lvl3': { pairs: 4, cols: 4, name: '4x2 (Rookie)' },Â  Â  // 8 cards
Â  Â  Â  'lvl4': { pairs: 6, cols: 4, name: '4x3 (Casual)' },Â  Â  // 12 cards
Â  Â  Â  'lvl5': { pairs: 8, cols: 4, name: '4x4 (Standard)' },Â  // 16 cards
Â  Â  Â  'lvl6': { pairs: 10, cols: 5, name: '5x4 (Challenger)' }, // 20 cards
Â  Â  Â  'lvl7': { pairs: 12, cols: 5, name: '5x5 (Pro)' },Â  Â  // 24 cards
Â  Â  Â  'lvl8': { pairs: 12, cols: 6, name: '6x4 (Advanced)' }, // 24 cards
Â  Â  Â  'lvl9': { pairs: 15, cols: 6, name: '6x5 (Master)' },Â  Â // 30 cards
Â  Â  Â  'lvl10':{ pairs: 18, cols: 6, name: '6x6 (Grandmaster)' } // 36 cards
Â  Â  };

Â  Â  let deck = [];
Â  Â  let firstPick = null;
Â  Â  let secondPick = null;
Â  Â  let lockBoard = false;
Â  Â  let moves = 0;
Â  Â  let seconds = 0;
Â  Â  let timer = null;

Â  Â  const shuffle = (arr) => {
Â  Â  Â  const a = arr.slice();
Â  Â  Â  for (let i = a.length - 1; i > 0; i--) {
Â  Â  Â  Â  const j = Math.floor(Math.random() * (i + 1));
Â  Â  Â  Â  [a[i], a[j]] = [a[j], a[i]];
Â  Â  Â  }
Â  Â  Â  return a;
Â  Â  };

Â  Â  const fmtTime = (s) => {
Â  Â  Â  const mm = String(Math.floor(s / 60)).padStart(2, '0');
Â  Â  Â  const ss = String(s % 60).padStart(2, '0');
Â  Â  Â  return `${mm}:${ss}`;
Â  Â  };

Â  Â  function buildDeck(pairs) {
Â  Â  Â  const symbols = allSymbols.slice(0, pairs);
Â  Â  Â  const base = symbols.flatMap((sym, idx) => ([
Â  Â  Â  Â  { id: `${idx}-a`, symbol: sym, matched: false },
Â  Â  Â  Â  { id: `${idx}-b`, symbol: sym, matched: false },
Â  Â  Â  ]));
Â  Â  Â  return shuffle(base);
Â  Â  }

Â  Â  function renderBoard(cols) {
Â  Â  Â  boardEl.innerHTML = '';
Â  Â  Â  boardEl.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
Â  Â  Â  boardEl.style.maxWidth = cols > 4 ? '700px' : '600px';

Â  Â  Â  deck.forEach((card, index) => {
Â  Â  Â  Â  const cardEl = document.createElement('div');
Â  Â  Â  Â  cardEl.className = 'card';
Â  Â  Â  Â  cardEl.dataset.index = index;

Â  Â  Â  Â  const btn = document.createElement('button');
Â  Â  Â  Â  btn.className = 'cardBtn';
Â  Â  Â  Â  btn.type = 'button';
Â  Â  Â  Â  btn.setAttribute('aria-label', card.matched ? `Matched ${card.symbol}` : 'Hidden card');

Â  Â  Â  Â  const inner = document.createElement('div');
Â  Â  Â  Â  inner.className = 'inner';

Â  Â  Â  Â  const front = document.createElement('div');
Â  Â  Â  Â  front.className = 'face front';
Â  Â  Â  Â  front.textContent = card.symbol;

Â  Â  Â  Â  const back = document.createElement('div');
Â  Â  Â  Â  back.className = 'face back';
Â  Â  Â  Â  back.textContent = 'â˜…';

Â  Â  Â  Â  inner.appendChild(front);
Â  Â  Â  Â  inner.appendChild(back);
Â  Â  Â  Â  btn.appendChild(inner);
Â  Â  Â  Â  cardEl.appendChild(btn);
Â  Â  Â  Â  boardEl.appendChild(cardEl);
Â  Â  Â  });
Â  Â  Â  updateFlips();
Â  Â  }

Â  Â  function updateHUD() {
Â  Â  Â  movesEl.textContent = moves;
Â  Â  Â  clockEl.textContent = fmtTime(seconds);
Â  Â  }

Â  Â  function updateFlips() {
Â  Â  Â  boardEl.querySelectorAll('.card').forEach((el, idx) => {
Â  Â  Â  Â  const card = deck[idx];
Â  Â  Â  Â  const isFlipped = (firstPick && firstPick.idx === idx) || (secondPick && secondPick.idx === idx) || card.matched;
Â  Â  Â  Â  el.classList.toggle('flipped', isFlipped);
Â  Â  Â  Â  el.classList.toggle('matched', card.matched);
Â  Â  Â  });
Â  Â  }

Â  Â  function startTimer() {
Â  Â  Â  stopTimer();
Â  Â  Â  timer = setInterval(() => {
Â  Â  Â  Â  seconds += 1;
Â  Â  Â  Â  clockEl.textContent = fmtTime(seconds);
Â  Â  Â  }, 1000);
Â  Â  }
Â  Â  function stopTimer() { if (timer) { clearInterval(timer); timer = null; } }

Â  Â  function allMatched() { return deck.every(c => c.matched); }

Â  Â  function startGame() {
Â  Â  Â  document.documentElement.requestFullscreen?.().catch(()=>{});
Â  Â  Â  show(memGame);

Â  Â  Â  const level = memLevels[memLevelStart.value];
Â  Â  Â  deck = buildDeck(level.pairs);
Â  Â  Â  firstPick = null;
Â  Â  Â  secondPick = null;
Â  Â  Â  lockBoard = false;
Â  Â  Â  moves = 0;
Â  Â  Â  seconds = 0;
Â  Â  Â  updateHUD();
Â  Â  Â  renderBoard(level.cols);
Â  Â  Â  startTimer();
Â  Â  }

Â  Â  function restartGame() {
Â  Â  Â  const level = memLevels[memLevelStart.value];
Â  Â  Â  deck = buildDeck(level.pairs);
Â  Â  Â  firstPick = null;
Â  Â  Â  secondPick = null;
Â  Â  Â  lockBoard = false;
Â  Â  Â  moves = 0;
Â  Â  Â  seconds = 0;
Â  Â  Â  winOverlay.classList.remove('show');
Â  Â  Â  updateHUD();
Â  Â  Â  renderBoard(level.cols);
Â  Â  Â  stopTimer();
Â  Â  Â  startTimer();
Â  Â  }

Â  Â  function handleCardTap(idx) {
Â  Â  Â  if (lockBoard) return;
Â  Â  Â  const card = deck[idx];
Â  Â  Â  if (card.matched) return;

Â  Â  Â  if (firstPick && firstPick.idx === idx) return;
Â  Â  Â  if (secondPick && secondPick.idx === idx) return;

Â  Â  Â  if (!firstPick) {
Â  Â  Â  Â  firstPick = { idx, symbol: card.symbol };
Â  Â  Â  Â  updateFlips();
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  if (!secondPick) {
Â  Â  Â  Â  secondPick = { idx, symbol: card.symbol };
Â  Â  Â  Â  lockBoard = true;
Â  Â  Â  Â  moves += 1;
Â  Â  Â  Â  updateHUD();
Â  Â  Â  Â  updateFlips();

Â  Â  Â  Â  if (firstPick.symbol === secondPick.symbol) {
Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  deck[firstPick.idx].matched = true;
Â  Â  Â  Â  Â  Â  deck[secondPick.idx].matched = true;
Â  Â  Â  Â  Â  Â  firstPick = null;
Â  Â  Â  Â  Â  Â  secondPick = null;
Â  Â  Â  Â  Â  Â  lockBoard = false;
Â  Â  Â  Â  Â  Â  updateFlips();

Â  Â  Â  Â  Â  Â  if (allMatched()) {
Â  Â  Â  Â  Â  Â  Â  stopTimer();
Â  Â  Â  Â  Â  Â  Â  winStatsEl.textContent = `${moves} moves Â· ${fmtTime(seconds)}`;
Â  Â  Â  Â  Â  Â  Â  winOverlay.classList.add('show');
Â  Â  Â  Â  Â  Â  Â  try { navigator.vibrate && navigator.vibrate(30); } catch {}
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }, 300);
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  firstPick = null;
Â  Â  Â  Â  Â  Â  secondPick = null;
Â  Â  Â  Â  Â  Â  lockBoard = false;
Â  Â  Â  Â  Â  Â  updateFlips();
Â  Â  Â  Â  Â  }, 700);
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }

Â  Â  startBtn.addEventListener('click', startGame);
Â  Â  restartBtn.addEventListener('click', restartGame);
Â  Â  playAgainBtn.addEventListener('click', restartGame);

Â  Â  boardEl.addEventListener('click', (e) => {
Â  Â  Â  const cardEl = e.target.closest('.card');
Â  Â  Â  if (!cardEl) return;
Â  Â  Â  const idx = Number(cardEl.dataset.index);
Â  Â  Â  handleCardTap(idx);
Â  Â  }, { passive: true });

Â  Â  document.addEventListener('touchmove', (e) => {
Â  Â  Â  if (!memGame.classList.contains('show')) return;
Â  Â  Â  e.preventDefault();
Â  Â  }, { passive: false });

Â  Â  memBack.addEventListener('click', () => { stopTimer(); show(scrMenu); });
Â  Â  memBackInGame.addEventListener('click', () => { stopTimer(); show(scrMenu); });

Â  Â  /* ======= MATH QUIZ (10+ Levels) ======= */
Â  Â  const mqPlayÂ  Â = document.getElementById('mqPlay');
Â  Â  const mqRestart= document.getElementById('mqRestart');
Â  Â  const mqBackÂ  Â = document.getElementById('mqBack');
Â  Â  const mqBackInGame = document.getElementById('mqBackInGame');
Â  Â  const levelÂ  Â  = document.getElementById('level');
Â  Â  const levelStart = document.getElementById('levelStart');
Â  Â  const qElÂ  Â  Â  = document.getElementById('question');
Â  Â  const optsElÂ  Â = document.getElementById('options');
Â  Â  const scoreElÂ  = document.getElementById('score');
Â  Â  const countElÂ  = document.getElementById('count');
Â  Â  const nowTagÂ  Â = document.getElementById('nowTag');

Â  Â  const allLevels = ['basic','c6','c7','c8','c9','c10','adult','advanced','prealgebra','algebra','graduate'];
Â  Â  const labels = {
Â  Â  Â  basic:'1: Basic Arithmetic', c6:'2: Whole Numbers', c7:'3: Multiplication/Subtraction', c8:'4: All Operations',
Â  Â  Â  c9:'5: Order of Operations', c10:'6: Exponents/Distributive', adult:'7: Decimals/Percentages (L1)',
Â  Â  Â  advanced: '8: Decimals/Percentages (L2)', prealgebra: '9: Pre-Algebra', algebra: '10: Algebra/Equations',
Â  Â  Â  graduate: '11: Graduate Level'
Â  Â  };

Â  Â  let preferred = 'c6';
Â  Â  let mqScore = 0;
Â  Â  let mqCount = 0;
Â  Â  let mqLockÂ  = false;
Â  Â  let coverageQueue = [];

Â  Â  const rand = (min,max)=> Math.floor(Math.random()*(max-min+1))+min;
Â  Â  const choice = (arr)=> arr[Math.floor(Math.random()*arr.length)];
Â  Â  function shuffleArr(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }
Â  Â  function vibrate(ms=25){ try{ navigator.vibrate && navigator.vibrate(ms); }catch{} }
Â  Â  const to1 = (n)=> Math.round(n*10)/10;
Â  Â  const to2 = (n)=> Math.round(n*100)/100;
Â  Â  const fmt = (n, kind) => kind==='dec1' ? Number(n).toFixed(1) : kind==='dec2' ? Number(n).toFixed(2) : String(n);

Â  Â  // --- LEVEL GENERATORS (11 Total) ---
Â  Â  function genBasic(){
Â  Â  Â  const op = Math.random()<0.5?'+':'-';
Â  Â  Â  let a = rand(1,15), b = rand(1,15);
Â  Â  Â  if (op==='-' && b>a) [a,b]=[b,a];
Â  Â  Â  const ans = op==='+' ? a+b : a-b;
Â  Â  Â  return {text:`${a} ${op} ${b} = ?`, answer: ans, kind:'int'};
Â  Â  }
Â  Â  function genC6(){
Â  Â  Â  const op = Math.random()<0.5?'+':'-';
Â  Â  Â  let a = rand(0,50), b = rand(0,50);
Â  Â  Â  if (op==='-' && b>a) [a,b]=[b,a];
Â  Â  Â  const ans = op==='+' ? a+b : a-b;
Â  Â  Â  return {text:`${a} ${op} ${b} = ?`, answer: ans, kind:'int'};
Â  Â  }
Â  Â  function genC7(){
Â  Â  Â  const ops=['+','-','Ã—']; const op=choice(ops);
Â  Â  Â  let a, b, ans;
Â  Â  Â  if (op==='Ã—'){ a = rand(2,12); b = rand(2,12); ans = a*b; }
Â  Â  Â  else if (op==='-'){ a = rand(0,100); b = rand(0,a); ans = a-b; }
Â  Â  Â  else { a = rand(0,80); b = rand(0,80); ans = a+b; }
Â  Â  Â  return {text:`${a} ${op} ${b} = ?`, answer: ans, kind:'int'};
Â  Â  }
Â  Â  function genC8(){
Â  Â  Â  const ops=['+','-','Ã—','Ã·']; const op=choice(ops);
Â  Â  Â  let a,b,ans;
Â  Â  Â  if (op==='Ã·'){ b = rand(2,12); ans = rand(2,12); a = b*ans; }
Â  Â  Â  else if (op==='Ã—'){ a=rand(3,20); b=rand(3,20); ans=a*b; }
Â  Â  Â  else if (op==='-'){ a=rand(30,150); b=rand(0,a); ans=a-b; }
Â  Â  Â  else { a=rand(10,120); b=rand(10,120); ans=a+b; }
Â  Â  Â  return {text:`${a} ${op} ${b} = ?`, answer:ans, kind:'int'};
Â  Â  }
Â  Â  function genC9(){
Â  Â  Â  const pattern = choice(['(a+b)Ã—c','(a-b)Ã—c','aÃ—b+c','aÃ—b-b','a+bÃ—c']);
Â  Â  Â  let a,b,c,ans,txt;
Â  Â  Â  switch(pattern){
Â  Â  Â  Â  case '(a+b)Ã—c': a=rand(5,20); b=rand(5,20); c=rand(2,12); ans=(a+b)*c; txt=`(${a} + ${b}) Ã— ${c} = ?`; break;
Â  Â  Â  Â  case '(a-b)Ã—c': a=rand(10,30); b=rand(0,a-5); c=rand(2,12); ans=(a-b)*c; txt=`(${a} - ${b}) Ã— ${c} = ?`; break;
Â  Â  Â  Â  case 'aÃ—b+c':Â  Â a=rand(5,20); b=rand(5,15); c=rand(5,60); ans=a*b+c; txt=`${a} Ã— ${b} + ${c} = ?`; break;
Â  Â  Â  Â  case 'a+bÃ—c':Â  Â a=rand(5,20); b=rand(5,15); c=rand(2,12); ans=a+b*c; txt=`${a} + ${b} Ã— ${c} = ?`; break; // Order of ops test
Â  Â  Â  Â  default:Â  Â  Â  Â  a=rand(5,20); b=rand(2,10); ans=a*b-b; txt=`${a} Ã— ${b} - ${b} = ?`;
Â  Â  Â  }
Â  Â  Â  return {text:txt, answer:ans, kind:'int'};
Â  Â  }
Â  Â  function genC10(){
Â  Â  Â  const pattern = choice(['aÂ² + b','aÂ² - b','aÃ—b + cÂ²','(a+b)Â²','a(b+c)']);
Â  Â  Â  let a,b,c,ans,txt;
Â  Â  Â  switch(pattern){
Â  Â  Â  Â  case 'aÂ² + b': a=rand(3,15); b=rand(5,60); ans=a*a+b; txt=`${a}Â² + ${b} = ?`; break;
Â  Â  Â  Â  case 'aÂ² - b': a=rand(6,15); b=rand(1,a*a-5); ans=a*a-b; txt=`${a}Â² - ${b} = ?`; break;
Â  Â  Â  Â  case 'aÃ—b + cÂ²': a=rand(3,12); b=rand(3,12); c=rand(2,10); ans=a*b+c*c; txt=`${a} Ã— ${b} + ${c}Â² = ?`; break;
Â  Â  Â  Â  case '(a+b)Â²': a=rand(3,12); b=rand(3,12); ans=(a+b)*(a+b); txt=`(${a} + ${b})Â² = ?`; break;
Â  Â  Â  Â  default: a=rand(3,15); b=rand(3,12); c=rand(3,12); ans=a*(b+c); txt=`${a}(${b} + ${c}) = ?`;
Â  Â  Â  }
Â  Â  Â  return {text:txt, answer:ans, kind:'int'};
Â  Â  }
Â  Â  function genAdult(){
Â  Â  Â  const pattern = choice(['decAdd','percentOf','decMul','mixPercAdd']);
Â  Â  Â  let a,b,ans,txt;
Â  Â  Â  switch(pattern){
Â  Â  Â  Â  case 'decAdd':
Â  Â  Â  Â  Â  a = to1(rand(10,200)/10); b = to1(rand(10,200)/10); ans = to1(a+b);
Â  Â  Â  Â  Â  txt = `${a} + ${b} = ?`; break;
Â  Â  Â  Â  case 'percentOf':
Â  Â  Â  Â  Â  a = rand(10,90); b = rand(20,400); ans = to1(a*b/100);
Â  Â  Â  Â  Â  txt = `${a}% of ${b} = ?`; break;
Â  Â  Â  Â  case 'decMul':
Â  Â  Â  Â  Â  a = to1(rand(10,150)/10); b = to1(rand(10,150)/10); ans = to2(a*b);
Â  Â  Â  Â  Â  txt = `${a} Ã— ${b} = ?`; break;
Â  Â  Â  Â  default:
Â  Â  Â  Â  Â  a = rand(10,60); b = to1(rand(50,200)/10); ans = to2((a/100)*b + b);
Â  Â  Â  Â  Â  txt = `${a}% of ${b} + ${b} = ?`; break;
Â  Â  Â  }
Â  Â  Â  return {text:txt, answer:ans, kind: pattern === 'decAdd' ? 'dec1' : 'dec2'};
Â  Â  }
Â  Â  function genAdvanced(){
Â  Â  Â  const pattern = choice(['decDiv','tax','discount','mixPercDiv']);
Â  Â  Â  let a,b,ans,txt;
Â  Â  Â  switch(pattern){
Â  Â  Â  Â  case 'decDiv':
Â  Â  Â  Â  Â  a = rand(50,300); b = rand(2,15); ans = to2(a/b);
Â  Â  Â  Â  Â  txt = `${a} Ã· ${b} = ? (2dp)`; break;
Â  Â  Â  Â  case 'tax':
Â  Â  Â  Â  Â  a = choice([5, 8, 10, 15]); b = rand(500,2000); ans = to2(b * (1 + a/100));
Â  Â  Â  Â  Â  txt = `${b} + ${a}% tax = ?`; break;
Â  Â  Â  Â  case 'discount':
Â  Â  Â  Â  Â  a = choice([10, 20, 25, 50]); b = rand(30,150); ans = to2(b * (1 - a/100));
Â  Â  Â  Â  Â  txt = `${b} less ${a}% discount = ?`; break;
Â  Â  Â  Â  default:
Â  Â  Â  Â  Â  a = rand(10,40); b = rand(100,500); ans = to2(b / (1 - a/100));
Â  Â  Â  Â  Â  txt = `${b} is ${100-a}% of what?`; break;
Â  Â  Â  }
Â  Â  Â  return {text:txt, answer:ans, kind:'dec2'};
Â  Â  }
Â  Â  function genPreAlgebra(){
Â  Â  Â  const pattern = choice(['fracAdd','fracMul','integerMix']);
Â  Â  Â  let a,b,c,d,ans,txt;
Â  Â  Â  switch(pattern){
Â  Â  Â  Â  case 'fracAdd': // Simple fractions with common denominator
Â  Â  Â  Â  Â  c = rand(2,8); a=rand(1,c-1); b=rand(1,c-1); ans=a/c+b/c;
Â  Â  Â  Â  Â  txt = `${a}/${c} + ${b}/${c} = ?`; break;
Â  Â  Â  Â  case 'fracMul': // Simple fraction multiplication
Â  Â  Â  Â  Â  a=rand(1,5); b=rand(2,10); c=rand(1,5); d=rand(2,10); ans=(a/b)*(c/d);
Â  Â  Â  Â  Â  txt = `${a}/${b} Ã— ${c}/${d} = ?`; break;
Â  Â  Â  Â  default: // Mixed positive/negative integers
Â  Â  Â  Â  Â  a = rand(-20,20); b = rand(-15,15); c = rand(1,5); ans = a + b * c;
Â  Â  Â  Â  Â  txt = `${a} + (${b}) Ã— ${c} = ?`; break;
Â  Â  Â  }
Â  Â  Â  return {text:txt, answer:to2(ans), kind: pattern.includes('frac') ? 'dec2' : 'int'};
Â  Â  }
Â  Â  function genAlgebra(){
Â  Â  Â  const pattern = choice(['linEq1','linEq2']);
Â  Â  Â  let a,b,c,ans,txt;
Â  Â  Â  switch(pattern){
Â  Â  Â  Â  case 'linEq1': // ax + b = c
Â  Â  Â  Â  Â  a=rand(2,5); b=rand(1,10); c=rand(15,40); ans=(c-b)/a;
Â  Â  Â  Â  Â  txt = `${a}x + ${b} = ${c}. x = ?`; break;
Â  Â  Â  Â  default: // a(x+b) = c
Â  Â  Â  Â  Â  a=rand(2,4); b=rand(1,5); c=rand(20,60);
Â  Â  Â  Â  Â  ans=c/a-b;
Â  Â  Â  Â  Â  txt = `${a}(x + ${b}) = ${c}. x = ?`; break;
Â  Â  Â  }
Â  Â  Â  return {text:txt, answer:to2(ans), kind: Math.abs(ans - Math.round(ans)) < 0.01 ? 'int' : 'dec2'};
Â  Â  }
Â  Â  function genGraduate(){
Â  Â  Â  const pattern = choice(['pythag','sqrt','exponents']);
Â  Â  Â  let a,b,ans,txt;
Â  Â  Â  switch(pattern){
Â  Â  Â  Â  case 'pythag':
Â  Â  Â  Â  Â  a=rand(3,8); b=rand(3,8); ans=Math.sqrt(a*a+b*b);
Â  Â  Â  Â  Â  txt = `Hypotenuse of triangle with legs ${a}, ${b}? (2dp)`; break;
Â  Â  Â  Â  case 'sqrt':
Â  Â  Â  Â  Â  a = rand(100,500); ans = Math.sqrt(a);
Â  Â  Â  Â  Â  txt = `âˆš${a} = ? (2dp)`; break;
Â  Â  Â  Â  default: // e.g. a^b / a^c
Â  Â  Â  Â  Â  a=rand(2,5); b=rand(4,8); c=rand(1,3); ans=a**(b-c);
Â  Â  Â  Â  Â  txt = `${a}^${b} Ã· ${a}^${c} = ?`; break;
Â  Â  Â  }
Â  Â  Â  return {text:txt, answer:to2(ans), kind: pattern === 'exponents' ? 'int' : 'dec2'};
Â  Â  }

Â  Â  const generators = {
Â  Â  Â  basic: genBasic, c6: genC6, c7: genC7, c8: genC8, c9: genC9, c10: genC10,
Â  Â  Â  adult: genAdult, advanced: genAdvanced, prealgebra: genPreAlgebra, algebra: genAlgebra,
Â  Â  Â  graduate: genGraduate
Â  Â  };
Â  Â  Â  

Â  Â  function buildOptions(answer, kind='int'){
Â  Â  Â  const opts = new Set([fmt(answer, kind)]);
Â  Â  Â  const nudge = ()=> {
Â  Â  Â  Â  let delta;
Â  Â  Â  Â  if (kind==='dec1' || kind==='dec2'){
Â  Â  Â  Â  Â  const magnitude = kind==='dec1' ? 10 : 100;
Â  Â  Â  Â  Â  delta = (rand(1,9)/magnitude) * (Math.random()<0.5?-1:1) * choice([1, 10]);
Â  Â  Â  Â  Â  return kind==='dec1' ? to1(answer+delta) : to2(answer+delta);
Â  Â  Â  Â  }
Â  Â  Â  Â  const base = Math.max(1, Math.round(Math.abs(answer)*0.1));
Â  Â  Â  Â  delta = choice([1,2,3, base, base+1]) * (Math.random()<0.5?-1:1);
Â  Â  Â  Â  let val = answer + delta;
Â  Â  Â  Â  if (val===answer) val += (delta>0?1:-1);
Â  Â  Â  Â  return val;
Â  Â  Â  };

Â  Â  Â  while (opts.size < 4){
Â  Â  Â  Â  const v = nudge();
Â  Â  Â  Â  opts.add(fmt(v, kind));
Â  Â  Â  }
Â  Â  Â  return shuffleArr(Array.from(opts));
Â  Â  }

Â  Â  function initCoverageQueue(){ coverageQueue = shuffleArr(allLevels.slice()); }
Â  Â  function chooseLevelForNext(){ return coverageQueue.length ? coverageQueue[coverageQueue.length-1] : preferred; }
Â  Â  function consumeCoverageIfUsed(levelUsed){
Â  Â  Â  if (coverageQueue.length && coverageQueue[coverageQueue.length - 1] === levelUsed){
Â  Â  Â  Â  coverageQueue.pop();
Â  Â  Â  }
Â  Â  }
Â  Â  function updateNowTag(levelUsed){ nowTag.textContent = `Now: ${labels[levelUsed]}`; }

Â  Â  function mqStartGame(){
Â  Â  Â  document.documentElement.requestFullscreen?.().catch(()=>{});
Â  Â  Â  preferred = levelStart.value;
Â  Â  Â  level.value = preferred;
Â  Â  Â  mqScore = 0; mqCount = 0; mqLock = false;
Â  Â  Â  scoreEl.textContent = mqScore; countEl.textContent = mqCount;
Â  Â  Â  initCoverageQueue();
Â  Â  Â  show(mqGame);
Â  Â  Â  nextQuestion();
Â  Â  }

Â  Â  function mqRestartGame(){
Â  Â  Â  mqScore = 0; mqCount = 0; mqLock=false;
Â  Â  Â  scoreEl.textContent = mqScore; countEl.textContent = mqCount;
Â  Â  Â  initCoverageQueue();
Â  Â  Â  nextQuestion();
Â  Â  }

Â  Â  function nextQuestion(){
Â  Â  Â  const lvl = chooseLevelForNext();
Â  Â  Â  const gen = generators[lvl] || generators.basic;
Â  Â  Â  const {text, answer, kind} = gen();
Â  Â  Â  qEl.textContent = text;
Â  Â  Â  updateNowTag(lvl);
Â  Â  Â  const options = buildOptions(answer, kind);
Â  Â  Â  renderOptions(options, answer, kind, lvl);
Â  Â  Â  countEl.textContent = ++mqCount;
Â  Â  }

Â  Â  function renderOptions(options, answer, kind, lvl){
Â  Â  Â  optsEl.innerHTML = '';
Â  Â  Â  options.forEach(val => {
Â  Â  Â  Â  const btn = document.createElement('button');
Â  Â  Â  Â  btn.className = 'mq-opt';
Â  Â  Â  Â  btn.type = 'button';
Â  Â  Â  Â  btn.textContent = val;
Â  Â  Â  Â  btn.ontouchstart = e => e.preventDefault();
Â  Â  Â  Â  btn.addEventListener('click', () => handlePick(btn, val, answer, kind, lvl), {passive:true});
Â  Â  Â  Â  optsEl.appendChild(btn);
Â  Â  Â  });
Â  Â  }

Â  Â  function eq(a, b, kind){
Â  Â  Â  const tolerance = 0.01;
Â  Â  Â  const nA = parseFloat(a);
Â  Â  Â  const nB = parseFloat(b);
Â  Â  Â  if (kind==='dec1' || kind==='dec2'){
Â  Â  Â  Â  return Math.abs(nA-nB) < tolerance;
Â  Â  Â  }
Â  Â  Â  return nA===nB;
Â  Â  }

Â  Â  function handlePick(btn, val, answer, kind, lvl){
Â  Â  Â  if (mqLock) return;
Â  Â  Â  mqLock = true;
Â  Â  Â  
Â  Â  Â  // Format answer for comparison to match the option's text format
Â  Â  Â  const formattedAnswer = fmt(answer, kind);
Â  Â  Â  const correct = eq(val, formattedAnswer, kind);
Â  Â  Â  
Â  Â  Â  btn.classList.add(correct ? 'correct' : 'wrong');
Â  Â  Â  if (correct){ mqScore++; scoreEl.textContent = mqScore; vibrate(25); }
Â  Â  Â  else { vibrate(60); [...optsEl.children].forEach(b=>{ if (eq(b.textContent, formattedAnswer, kind)) b.classList.add('correct'); }); }

Â  Â  Â  consumeCoverageIfUsed(lvl);
Â  Â  Â  setTimeout(()=>{ mqLock=false; nextQuestion(); }, correct ? 550 : 900);
Â  Â  }

Â  Â  mqPlay.addEventListener('click', mqStartGame);
Â  Â  mqRestart.addEventListener('click', mqRestartGame);
Â  Â  level.addEventListener('change', e => { preferred = e.target.value; });

Â  Â  mqBack.addEventListener('click', () => show(scrMenu));
Â  Â  mqBackInGame.addEventListener('click', () => show(scrMenu));

Â  Â  // Prevent pull-to-refresh during active game screens
Â  Â  document.addEventListener('touchmove', (e) => {
Â  Â  Â  if (memGame.classList.contains('show') || mqGame.classList.contains('show')) e.preventDefault();
Â  Â  }, { passive: false });
Â  </script>
</body>
</html>
